arm

ARM体系结构编程(10天)
linux系统移植(linux在板子上运行)(5天)
Linux驱动开发(15天)
项目:
	智能车(WIFI)-5天
	智能家居控制系统-7天
	
课程之间的关联性比较松散,单元性比较强:
涉及知识面比较广泛:

第一个:开发板准备好,下午用
第二个:虚拟机环境准备好:
	vmware
	注意:安装后尽量不要汉化,拿到能在vmware上运行的ubuntu系统,压缩包在２G左右
第三个:从现在开始使用TTS6,开通TTS6帐号:看以前的内容需要用TTS5,看今天内容看TTS6:
嵌入式问题交流群:175705253/esd1309

嵌入式系统基础
ARM体系结构与编程基础

综合性,知识点独立,系统性不足;
加深对基础课程的理解,为系统软件开发打基础;

1.理解嵌入式的本质/特征/明确重点;
2.了解ARM架构,重点掌握ARM的编程模型;//90％以上都是ARM架构
3.熟悉汇编软件开发;
4.了解硬件/裸板软件开发的方法;
5.培养阅读能力,适应看文档,为以后学习打下好基础,适应独立解决问题,提高综合技能;
难在阅读文档能力(全英文的),阅读源代码的能力;

需要看ARM的文档,用C语言写代码;

什么是嵌入式?

记忆式学习
1.记忆
2.练习(动手实践,反推)
3.理解

要求:
	脱稿
	强制自己动手写代码;
10天:
1> 概述
2> 裸板led
3> 串口驱动
4> Shell编程
5> nand flash闪存驱动开发
6> Linux内核加载程序编写
7> ARM体系结构＆指令集
8> ARM异常＆中断
9> S5PV210启动流程＆独立运行体验:

什么是嵌入式系统?
	常见嵌入式产品:便携式音响设备/路由器/DVD/MP3/游戏机/数码相机/手机/平板/智能电视/机顶盒/机器人/无人机/电子医疗/汽车电子/车载娱乐
	创新点比较多,只有想不到,没有做不到://创客,以前的黑客
	有一些互联网公司开始做硬件:
	关注行业发展动态,和发展历史:
	微软:技术创新:
	google:体验创新:
	科技创新是没有终点的:
	创新需要经济成本:
	
嵌入式系统
	是以应用为中心,以计算机技术为基础,软硬件可裁剪,适应应用系统对功能/可靠性/成本/体积及功耗严格要求的专用计算机系统.
	由硬件和软件共同构成的专用系统:
特点:嵌入/计算机/专用:量体裁衣,合适才好:
	首先学习计算机基础,再学习行业技术:
	找工作先找行业,关键要维持好自己的人品:
	实践先行,先做到而不是先想到:
	
	嵌入式系统的特点
		无处不在,无固定形态
		专用性强,软硬件多样化
			小型化功耗敏感成本敏感
			要求高可靠性高稳定性
			通常有实时性要求
		软件可固化
		有些行业要求芯片或器件的供货周期较长
		是多学科结合/技术密集/资金密集/高度分散/不断创新的知识集成系统:
		嵌入式系统开发通常需要专门的开发工具和开发环境:
		
云计算/大数据/物联网/车联网

网络编程/多进程/多线程

	主要嵌入式系统uCos-II/Nuclue/Threadx/Vxworks/QNX/Win8
			免费的Linux/Android/PalmWEBOS/TIZEN
			Nuttx
			
如何学习嵌入式?
	实践很重要/勤于实践/多练多看多想
	贵在坚持/积少成多
	关注行业发展/技术是为应用服务的
	学会沟通交流,利用好网络:
	熟悉一种微处理器体系机构
	熟悉硬件/能读懂原理图
	熟悉仪器/工具的使用
	锻炼看文档的能力
	学习嵌入式Linux软件开发还好熟悉GNU工具集的使用(binutils,gcc,make)/linux使用与shell编程等等.
	学好现在的,练好当前的,自然会有落脚之处:熟练了才有价值
	
	交叉编译
		开发主机host
		目标机Target
		连接介质//USB/RS232/Network Ethernet/JTAG(目标版不需要接收软件/无敌的)
	嵌入式软件开发平台化/标准化/系统可升级:
	嵌入式系统软件开发将逐渐PC化:
	
	嵌入式开发:
		开发工具软件运行在PC(开发主机上)
		开发好的软件运行在目标机上:
		开发主机和目标机之间需要连接介质:
			我们给出4个例子:
				USB/RS232/Network Ethernet
				JTAG(目标版不需要接收软件/无敌的)
			使用哪种根据硬件条件;
		嵌入式开发标准弱/差异化比较大:
			USB/RS232/Network Ethernet三种方式需要通信的两端都要有运行软件:
			JTAG方式目标机不需要软件,只要硬件正确,开发主机上运行相关软件就可以控制CPU运行或者想目标机下载数据;
		基于T-PAD平台嵌入式软件开发环境构成:
			开发主机:ubuntu12.04
			目标平台:T-PAD(S5PV210微处理器)
			开发工具:

我们的硬件目标平台:
    CPU是三星的:S5PV210  1Ghz,
               核心是 ARM ARM Cortex-A8
    CPU要想和外设备通信,需要通过CPU的管脚;
 
    CPU右侧两边有管脚的那个是闪存;nand flash
    CPU板子从上看有四个看不见管脚的方形芯片是内存,DDRII
    我们开发板上有1G bytes 内存
    
    板子上在白色的按键旁边有一组拨码开关(四个),决定CPU从什么设备上获得启动程序;
    有点类似PC机主板的BIOS里面选择启动盘的选项;决定CPU的启动方式的;

任务:向开发板安装一个软件
      让软件能运行;
      安装到开发板的闪存(nand flash);
      

回忆PC裸机安装WIN7过程;
   以光盘安装
   1/准备光盘(安装盘),可启动;
   2/启动计算机(主板的BIOS先运行)
      主板BIOS启动
      主板BIOS根据BIOS启动选项到对应设备上去找引导程序;
      把引导扇区上的引导程序加载到内存中,然后指向引导程序;
      引导程序自己能运行后,会把操作系统内核加载内存,然后运行;
      操作系统内核最终要加载应用程序,如果桌面,或者终端;
   3/配置BIOS的启动选项,配置光盘启动;
   4/光盘上的安装程序开始运行;
   5/安装程序把win7系统安装到硬盘(C:)
   6/移除光盘,重启系统;
   7/安装好的系统就可以启动了;
问题:
   假如:D盘有个文件test.bin,写个C程序把D盘的test.bin复制到C盘;
   1/打开d盘的test.bin
   2/再打开c盘test.bin
   3/从d盘test.bin读取数据到内存缓存区;
   4/把内存缓存区的数据写入到C盘test.bin
   5/循环3/4直到文件结束;
   6/关闭C盘的test.bin和D盘的test.bin

S5PV210这个cpu支持的启动方式有:
1/nand flash
2/大的SD座对应的卡
3/USB
4/UART(串口)
  这个CPU内部有一个ROM,ROM存放的三星出厂时就安装好的软件;
  CPU上电以后先执行ROM里面的代码;这段代码再判断是从nand flash/SD卡/ USB或者UART上获得启动程序;
  (ROM三星称之为IROM)
  
任务:向开发板安装一个软件
      让软件能运行;
      安装到开发板的闪存(nand flash);

    通过S5PV210的USB启动方式安装;
    1/需要知道怎么设置USB启动
       拨码开关
          1->ON  右
          2->OFF
          3->OFF
          4->ON
    2/需要PC机有USB发送程序;
          dnw
    3/需要能启动的代码和被安装的程序;
         u-boot.bin
         u-boot.bin
         
休息的同时做
    1/拿到arm-resource.rar
    2/把板子的连接线接好
       1/USB线
       2/串口线,一端接PC,另一端接开发板的COM1(靠近USB口的)
       3/网线
       4/电源线

  http://code.tarena.com.cn
  帐号:tarenacode
  密码:code_2013

步骤:
    准备工作已经做完;
    1/在PC机运行DNW软件;
    2/配置DNW软件;
       配置串口波特率:115200
       配置使用的串口号:COM1
         根据你使用的串口选择COM1
    3/串口配置完成,选择串口菜单
       connect,我们dnw标题条有变化
       至此,dnw串口功能可用了,
       如果开发板上的软件通过串口发送信息给PC,DWN可以收到,并且在DNW窗口显示;
    4/开发板开启电源
       如果是第一次使用usb启动,PC机会发现USB新硬件,会要求安装驱动;
       我们就按照提示安装驱动;
       第一个界面选择"从列表..."
       第二个界面选择"在搜索中..."             
             其他选项去掉
             点击"浏览"按钮

       如果不出安装驱动
       电源接通以后,按一下白色按键(拨码开关旁边),一秒钟;
   5/使用dnw通过usb向开发板发送程序
      CPU上IROM里面代码(三星出厂时带的)接收,并且把其存到内在中,接收完毕,IROM程序自动调用接收到的代码;
      配置dnw里面软件中的下载地址,即指开发板的内存地址;
      
      配置dnw的 Download Address为:0xd0020010(cpu内存)
->      向开发板发送程序:x210_usb.bin
     开发板的IROM程序自动接收x210.bin并保存到指定的内存地址,自动运行:
      下载成功之后,我们发现dnw标题条,USB:OK-X-OK
      
   6/再次修改下载地址:Download Address: 0x23E00000
->      发送u-boot.bin,
     	开发板端程序自动接收并存放到指定地址,自动运行:
     	dnw窗口会看到信息,开发板端运行的u-boot向pc发送的字符信息被dnw软件接收,并显示:
     	需要在dnw窗口按"空格"键进入到了u-boot界面:相当于安装程序已经运行了;
      	出现u-boot的命令行:
      	tarena #
      	相当于往pc机安装操作系统的时候,安装程序运行起来(只不过安装win7安装程序是带界面的,我们这个安装程序是命令行的),
   	
#  	然后在dnw窗口tarena #命令行下面执行
       	tarena #dnw  0x20008000
       	命令的作用是:通过usb获得pc上的代码或者数据放到开发板的内存中(0x20008000)
-> 	再次修改地址为0x20008000
     通过dnw的usb发送菜单,发送u-boot.bin
       此时u-boot.bin已经存在于开发板的内存中(0x20008000):
       
#    然后把内存中的u-boot.bin写入到开发板的闪存中;
       在tarena#下面输入命令:
       	nand  erase  0x0  0x100000//擦除原来闪存的内容
       	nand  write  0x20008000 0x0 0x100000//将内存中的内容写到闪存中


   nand flash 操作命令
   
   nand erase擦除闪存数据
   nand erase 闪存的位置  擦除大小
   nand erase 0x0  0x100000
   
   nand write命令把内存中数据写到闪存中
   nand write 内存地址  闪存位置  大小
   nand write 0x20008000 0x0  0x100000

   开发板的闪存中就有数据(u-boot.bin)
   断电(开发板电)
   调整开发板的拨码开关
    1->ON
    2->OFF
    3->OFF
    4->OFF
   重启开启电源,如果没有错误
   闪存中的u-boot将启动;
   
   
   
 	1 
   		x210_usb.bin -> 0xd0020010(cpu)
   	2
   		u-boot.bin -> 0x23e00000(DDRII)
   		#dnw 0x20008000
   	3
   		u-boot.bin -> 0x20008000(DDRII)
 
   	4
   		#nand erase 0x0 0x00100000
   		#nand write 0x20008000 0x0 0x000100000

